## 트랜잭션(Transaction)



- DB의 상태를 변화시키기 위해 수행하는 작업 단위

  => 여러 SQL 명령 묶음

  

  - ***작업 단위?***

    : 어떤 작업이냐에 따라 그 작업을 정의하는 기준에 따라 다를 수 있음



##### 특징

1. 원자성(Atomicity)

   - 트랜잭션 내 모든 명령이 모두 수행되거나, 혹은 모두 반영되지 않는 것

2. 일관성(Consistency)

   - 트랜잭션 작업 처리 결과는 항상 같아야 함

3. 독립성(Isolation)

   - 둘 이상의 트랙잭션이 동시에 병행될 때,

     어떤 트랜잭션도 다른 트랜잭션 연산에 끼어들 수 없음

4. 지속성(Durability)

   - 트랜잭션이 성공적으로 완료 시,

     결과는 영구적으로 반영되어야 함



##### Commit

- 한 트랜잭션이 성공적으로 완료 시,

  DB가 일관성 있는 상태일 때 이를 알려주기 위해 사용되는 연산



##### Rollback

- 하나의 트랜잭션 처리가 비정상적으로 종료되어 트랜잭션 원자성이 깨진 경우

  => 수행 중이었던 트랜잭션을 <u>수행 전으로 돌리는 연산</u>





#### 트랜잭션 관리를 위한 DBMS 전략



1. DBMS 구조

   ​	ㄱ. 질의 처리기(Query Processor)

   ​	ㄴ. 저장 시스템(Storage System)

   

   - 고정 길이의 page 단위로 disk에 읽거나 씀
   - 비휘발성 저장 장치인 disk에 저장, 일부분을 Main Memory에 저장



2. Page Buffer Manager 또는 Buffer Manager

   - DBMS의 Storage System에 속하는 모듈 중 하나

     => Main Memory에 유지하는 페이지를 관리하는 모듈

   - <u>Buffer 관리 정책에 따라</u> UNDO 복구, REDO 복구가 요구될 수도, 그렇지 않을 수도 있음



3. UNDO

   - 정상적으로 종료되지 않은 트랜잭션이 변경한 page들을 이전 상태로 복구

   - 버퍼 정책에 따라서 Undo가 필요하기도, 불필요하기도 함

     ㄱ. Steal ( 대부분의 DBMS 정책 )

     - 트랜잭션이 완료되지 않은 상태에서도 데이터를 디스크에 기록 가능

       => Undo 필요

     ㄴ. No-Steal

     - 트랜잭션이 완료되지 않았다면 버퍼에 끝까지 저장

       => <u>큰 버퍼가 필요</u>

       => Undo 불필요



4. REDO

   - 이미 COMMIT 한 트랜잭션의 수정을 재반영하는 복구 작업

   - 버퍼 정책에 따라서 Redo가 필요하기도, 불필요하기도 함

     ㄱ. Force

     - 트랜잭션 완료 후에는 바로 디스크에 기록

     ㄴ. No-Force ( 대부분의 DBMS 정책 )

     - 트랜잭션 완료 후에도 바로 디스크에 기록하는 것이 아니라

       일정 시간 마다 디스크에 기록하는 방법

       => Redo 필요